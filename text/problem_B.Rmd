\section{Problem B: Permutation test}

\subsection{1.}

```{r}

###################
# Prepare data
###################


bilirubin <- read.table("../files/bilirubin.txt", header = TRUE) %>% as_tibble()

```


```{r}

####################
# Create boxplot
###################

ggplot(data = bilirubin) +
  geom_boxplot(aes(x = pers, y = log(meas), fill = pers)) +
  scale_fill_discrete(guide = FALSE) +
  labs(x = "person",
       y = expression(log(meas)))

```
```{r}

lm <- lm(log(meas) ~ pers, data = bilirubin)

s <- summary(lm)
fval <- s$fstatistic[1]


```



\subsection{2.}

The function looks like this:

```{r permTest}
```

\subsection{3.}

```{r}
n <- 999

f_vec <- vector("numeric", n)

for(i in 1:n){
  f_vec[i] <- permTest(bilirubin)
}

ggplot(data = as.tibble(f_vec)) +
  geom_histogram(aes(x = value), bins = 50, boundary = 0) +
  geom_vline(xintercept = fval)


p_val <- length(which(f_vec >= fval)) / n

p_val

```
\todo[inline]{this is just some ranting because I haven't worked with inference in a long time.}
I think the way this works is that the permutation test was done because we assumed all coefficients equal and therefore could switch the data points. The p-val thus becomes the probability of more extreme f-values when the null hypothesis is true. It is equal to 0.03, so at a $5 \%$ significance level we reject the null hypothesis and assume different coefficients.

